<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard | GKK</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body class="p-4">
  <h2>Product Dashboard</h2>
  <form id="addProductForm" class="mb-3">
    <input type="text" id="name" placeholder="Name" required>
    <input type="text" id="category" placeholder="Category" required>
    <input type="number" id="price" placeholder="Price" required step="0.01">
    <button class="btn btn-success">Add Product</button>
  </form>

  <table class="table" id="productTable">
    <thead><tr><th>ID</th><th>Category</th><th>Name</th><th>Price</th><th>Action</th></tr></thead>
    <tbody></tbody>
  </table>

  <script>
    async function loadProducts() {
      const res = await fetch('/api/products/seeds'); // example category
      const data = await res.json();
      const tbody = document.querySelector("#productTable tbody");
      tbody.innerHTML = data.map(p => `
        <tr>
          <td>${p.id}</td><td>${p.category}</td><td>${p.name}</td><td>${p.price}</td>
          <td><button onclick="deleteProduct(${p.id})" class="btn btn-danger btn-sm">Delete</button></td>
        </tr>`).join('');
    }

    document.querySelector("#addProductForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const product = {
        name: document.getElementById("name").value,
        category: document.getElementById("category").value,
        price: document.getElementById("price").value
      };
      await fetch('/api/products', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(product)
      });
      loadProducts();
    });

    async function deleteProduct(id) {
      await fetch('/api/products/' + id, { method: 'DELETE' });
      loadProducts();
    }

    loadProducts();
  </script>
</body>
</html>
